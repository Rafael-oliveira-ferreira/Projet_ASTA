<!doctype html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>

    <!-- Réutilise le même style que la page d’accueil -->
    <link rel="stylesheet" th:href="@{/css/home.css}" />
    <title>Détails apprenti</title>
</head>
<body th:attr="data-apprentice-id=${apprentice != null ? apprentice.id : 0}">
<header class="header">
    <nav class="nav">
        <span class="user_badge"
              th:text="|Bienvenue ${apprentice.apprenticeshipMentor.firstName} ${apprentice.apprenticeshipMentor.lastName}|">
      Bienvenue Jean Smith
    </span>
        <div></div>
        <div class="buttons-container">
            <form th:action="@{/logout}" method="post" class="logout-form">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <button type="submit" class="btn-logout btn-ghost">Se déconnecter</button>
            </form>
        </div>
    </nav>
</header>


<main class="main">
    <a class="btn-return" th:href="@{/home}">← Retour à l’accueil</a>
    <section id="apprentice-details-section" class="card">
        <div class="card__header">
            <h2 class="card__title">Détails de l'apprenti</h2>
            <div class="card__actions">
                <button type="button" class="btn-edit" aria-label="Modifier apprenti" onclick="startEdit()">Modifier</button>
                <button type="button" class="btn-save hidden" aria-label="Enregistrer les modifications"
                        th:onclick="|saveEdit(${apprentice.id}, ${apprentice.company != null ? apprentice.company.id : null})|">
                    Enregistrer
                </button>
            </div>
        </div>

        <div class="card__body">
            <div class="info-grid">
                <div class="info-block">
                    <h3 class="info-block__title">Identité</h3>
                    <dl class="dl">
                        <div class="dl__row">
                            <dt>Nom</dt><dd id="span_last_name" th:text="${apprentice != null ? apprentice.lastName : ''}"></dd>
                        </div>
                        <div class="dl__row">
                            <dt>Prénom</dt><dd id="span_first_name" th:text="${apprentice != null ? apprentice.firstName : ''}"></dd>
                        </div>
                        <div class="dl__row">
                            <dt>Email</dt><dd id="span_email" th:text="${apprentice != null ? apprentice.email : ''}"></dd>
                        </div>
                        <div class="dl__row">
                            <dt>Téléphone</dt><dd id="span_phone" th:text="${apprentice.phone}"></dd>
                        </div>
                        <div class="dl__row" th:if="${apprentice.major}">
                            <dt>Parcours</dt>
                            <dd>
                                <span id="span_program" th:text="${apprentice.program}"></span>
                                <span id="span_major" th:text="' ' + ${apprentice.major}"></span>
                            </dd>
                        </div>
                        <div class="dl__row" th:if="${apprentice.academicYear}">
                            <dt>Année académique</dt><dd id="span_academic_year" th:text="${apprentice.academicYear}"></dd>
                        </div>
                    </dl>
                </div>

                <div class="info-block" th:if="${apprentice.company}">
                    <h3 class="info-block__title">Entreprise</h3>
                    <dl class="dl">
                        <div class="dl__row">
                            <dt>Nom</dt><dd id="span_company_name" th:text="${apprentice.company.companyName}"></dd>
                        </div>
                        <div class="dl__row">
                            <dt>Adresse</dt>
                            <dd id="span_company_address"
                                th:text="${apprentice.company.address != null ? apprentice.company.address : 'Non renseigné'}"></dd>
                        </div>
                        <div class="dl__row">
                            <dt>Infos d’accès</dt>
                            <dd id="span_company_info"
                                th:text="${apprentice.company.accessInfo != null ? apprentice.company.accessInfo : 'Non renseigné'}"></dd>
                        </div>
                    </dl>
                </div>
            </div>
        </div>

        <!-- Sous-fiches -->
        <div class="subcards">
            <article class="subcard">
                <header class="subcard__header"><h4>Mission</h4></header>
                <div class="subcard__body" id="mission-details">
                    <dl class="dl dl--compact">
                        <div class="dl__row"><dt>Mots-clés</dt><dd id="span_mission_keywords"></dd></div>
                        <div class="dl__row"><dt>Poste ciblé</dt><dd id="span_mission_target"></dd></div>
                        <div class="dl__row"><dt>Commentaires</dt><dd id="span_mission_comments"></dd></div>
                    </dl>
                </div>
            </article>

            <article class="subcard">
                <header class="subcard__header"><h4>Visite</h4></header>
                <div class="subcard__body" id="visit-details">
                    <dl class="dl dl--compact">
                        <div class="dl__row"><dt>Format</dt><dd id="visit-format"></dd></div>
                        <div class="dl__row"><dt>Date</dt><dd id="visit-date"></dd></div>
                        <div class="dl__row"><dt>Commentaires</dt><dd id="visit-comments"></dd></div>
                    </dl>
                </div>
            </article>

            <article class="subcard">
                <header class="subcard__header"><h4>Soutenance</h4></header>
                <div class="subcard__body" id="defense-details">
                    <dl class="dl dl--compact">
                        <div class="dl__row"><dt>Date</dt><dd id="denfense-date"></dd></div>
                        <div class="dl__row"><dt>Note</dt><dd id="defense-grade"></dd></div>
                        <div class="dl__row"><dt>Commentaires</dt><dd id="defense-comments"></dd></div>
                    </dl>
                </div>
            </article>

            <article class="subcard">
                <header class="subcard__header"><h4>Rapport</h4></header>
                <div class="subcard__body" id="report-details">
                    <dl class="dl dl--compact">
                        <div class="dl__row"><dt>Sujet</dt><dd id="report-subject"></dd></div>
                        <div class="dl__row"><dt>Note</dt><dd id="report-grade"></dd></div>
                        <div class="dl__row"><dt>Commentaires</dt><dd id="report-comments"></dd></div>
                    </dl>
                </div>
            </article>
        </div>
    </section>
</main>
<script th:src="@{/js/apprenticeDetails.js}"></script>
</body>
</html>
