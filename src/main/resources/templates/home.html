<!doctype html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="_csrf" th:content="${_csrf.token}" />
    <meta name="_csrf_header" th:content="${_csrf.headerName}" />
    <link rel="stylesheet" th:href="@{/css/home.css}" />
    <title>Accueil</title>
</head>
<body class="layout" th:attr="data-mentor-id=${apprenticementor != null ? apprenticementor.id : 0}">
<header class="header">
    <nav class="nav">
        <span class="user_badge"
              th:text="|Bienvenue ${apprenticementor.firstName} ${apprenticementor.lastName}|">
        Bienvenue Jean Smith
      </span>
        <form class="search" id="search-form" role="search" th:action="@{/recherche/{id}(id=${apprenticementor.id})}" method="get">
            <svg class="search__icon" width="16" height="16" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M21 21l-4.3-4.3m2.3-6.2A7 7 0 1 1 5 5a7 7 0 0 1 14 0z"
                      fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>

            <input type="search"
                   class="search__input"
                   id ="search-input"
                   name="q"
                   placeholder="Rechercher..."
                   th:value="${param.q}" />
            <button type="button" id="reset-search" class="btn-ghost">Réinitialiser</button>
            <p id="search-error" style="display:none;color:#b00020;margin-top:.4rem;">La recherche a échoué.</p>
        </form>
        <div class="buttons-container">
            <button type="button" id="new-year" class="btn-ghost" onclick="generateNewYear()">Nouvelle année académique</button>
            <form th:action="@{/logout}" method="post" class="logout-form">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <button type="submit" class="btn-logout btn-ghost">Se déconnecter</button>
            </form>
        </div>
    </nav>
</header>

<main class="main">
    <h1>Bienvenue sur ASTA</h1>
</main>

<section id="apprentices-section" style="margin-top: 1rem;">
    <h2>Apprentis</h2>
    <div class="btn-container">
        <button type="button" id="add-apprentice-btn" class="btn-edit" onclick="displayApprenticeForm()">Ajouter un apprenti</button>
    </div>
    <table id="apprentices-table" aria-describedby="apprentices-section">
        <thead>
        <tr>
            <th>Id</th>
            <th>Prénom</th>
            <th>Nom</th>
            <th>Actions</th>
        </tr>
        </thead>

        <tbody id="apprentices-tbody">
        <!-- rows injected here -->
        </tbody>
    </table>
    <div id="apprentice-form-container" class="hidden">
        <input type="text" id="apprentice-last-name" placeholder="Nom" />
        <input type="text" id="apprentice-first-name" placeholder="Prénom"  />
        <input type="email" id="apprentice-email" placeholder="Email" />
        <input type="text" id="apprentice-phone" placeholder="Téléphone" />
        <input type="text" id="apprentice-program" placeholder="Programme" />
        <input type="text" id="apprentice-academic-year" placeholder="Année académique" />
        <input type="text" id="apprentice-major" placeholder="Majeure" />
        <select id="apprentice-company">
            <option value="">Sélectionner une entreprise</option>
            <!-- options injected here -->
        </select>
        <span id="apprentice-error-msg" style="color:#b00020; display:none;"></span>
        <button type="button" id="save-apprentice-btn" class="btn btn-ghost" onclick="addApprentice()">Enregistrer</button>
        <button type="button" id="cancel-apprentice-btn" class="btn btn-ghost" onclick="hideApprenticeForm()">Annuler</button>
    </div>
    <div id="drawer-overlay" class="drawer-overlay hidden"></div>
    <p id="no-apprentices" style="display:none;">Aucun apprenti trouvé</p>
</section>
<script th:src="@{/js/home.js}"></script>
</body>
</html>